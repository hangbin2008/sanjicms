<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.title}}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .nav {
            display: flex;
            gap: 1.5rem;
        }

        .nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: opacity 0.2s ease;
        }

        .nav a:hover {
            opacity: 0.8;
        }

        .main {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .stats-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 2rem;
        }

        .stats-container h2 {
            margin-bottom: 2rem;
            color: #333;
            font-size: 1.8rem;
        }

        /* ç”¨æˆ·èœå•æ ·å¼ */
        .user-menu-container {
            position: relative;
        }

        .user-menu-trigger {
            position: relative;
            padding-right: 20px;
        }

        .user-menu-trigger::after {
            content: 'â–¼';
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.7rem;
        }

        .user-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            color: #333;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
            z-index: 1000;
            min-width: 150px;
        }

        .user-menu a {
            display: block;
            padding: 0.75rem 1rem;
            text-decoration: none;
            color: #333;
            border-bottom: 1px solid #e9ecef;
            transition: background-color 0.2s ease;
        }

        .user-menu a:hover {
            background-color: #f8f9fa;
        }

        .user-menu a:last-child {
            border-bottom: none;
            color: #dc3545;
        }

        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-card h3 {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }

        .stat-card .value {
            font-size: 2.5rem;
            font-weight: 700;
        }

        /* å›¾è¡¨å®¹å™¨ */
        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .chart-section {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 1.5rem;
        }

        .chart-section h3 {
            margin-bottom: 1.5rem;
            color: #333;
            font-size: 1.3rem;
            text-align: center;
        }

        .chart-container {
            height: 300px;
            background-color: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        /* æˆç»©åˆ†å¸ƒè¡¨æ ¼ */
        .score-distribution {
            margin-bottom: 2rem;
        }

        .score-distribution h3 {
            margin-bottom: 1.5rem;
            color: #333;
            font-size: 1.3rem;
        }

        .distribution-table {
            width: 100%;
            border-collapse: collapse;
        }

        .distribution-table th,
        .distribution-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .distribution-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        .distribution-table tr:hover {
            background-color: #f8f9fa;
        }

        /* è€ƒè¯•åˆ—è¡¨ */
        .exam-selector {
            margin-bottom: 2rem;
        }

        .exam-selector h3 {
            margin-bottom: 1rem;
            color: #333;
            font-size: 1.3rem;
        }

        .exam-selector select {
            padding: 0.75rem;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            min-width: 300px;
        }

        .exam-selector select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* æ’åè¡¨æ ¼ */
        .ranking-section {
            margin-bottom: 2rem;
        }

        .ranking-section h3 {
            margin-bottom: 1.5rem;
            color: #333;
            font-size: 1.3rem;
        }

        .ranking-table {
            width: 100%;
            border-collapse: collapse;
            overflow-x: auto;
        }

        .ranking-table th,
        .ranking-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .ranking-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        .ranking-table tr:hover {
            background-color: #f8f9fa;
        }

        .ranking-table .rank-1 {
            background-color: rgba(255, 215, 0, 0.2);
            font-weight: bold;
        }

        .ranking-table .rank-2 {
            background-color: rgba(192, 192, 192, 0.2);
            font-weight: bold;
        }

        .ranking-table .rank-3 {
            background-color: rgba(205, 127, 50, 0.2);
            font-weight: bold;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 1rem;
            }

            .nav {
                flex-wrap: wrap;
                justify-content: center;
            }

            .stats-container {
                padding: 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 250px;
            }

            .distribution-table,
            .ranking-table {
                font-size: 0.9rem;
            }

            .distribution-table th,
            .distribution-table td,
            .ranking-table th,
            .ranking-table td {
                padding: 0.5rem;
            }

            .exam-selector select {
                min-width: auto;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <h1>åŸºå±‚ä¸‰åŸºè€ƒè¯•ç³»ç»Ÿ</h1>
            <nav class="nav">
                <a href="/">é¦–é¡µ</a>
                <a href="/exams">æˆ‘çš„è€ƒè¯•</a>
                <a href="/records">è€ƒè¯•è®°å½•</a>
                <a href="/practice">æ¨¡æ‹Ÿç»ƒä¹ </a>
                <div class="user-menu-container">
                    <a href="#" class="user-menu-trigger" id="userMenuTrigger">{{.userName}}</a>
                    <div class="user-menu" id="userMenu">
                        <a href="/profile">ä¸ªäººä¸­å¿ƒ</a>
                        <a href="/change-password">ä¿®æ”¹å¯†ç </a>
                        <a href="/logout">é€€å‡ºç™»å½•</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="stats-container">
            <h2>è€ƒè¯•æˆç»©ç»Ÿè®¡åˆ†æ</h2>

            <!-- è€ƒè¯•é€‰æ‹©å™¨ -->
            <div class="exam-selector">
                <h3>é€‰æ‹©è€ƒè¯•</h3>
                <select id="examSelector">
                    <option value="all">æ‰€æœ‰è€ƒè¯•</option>
                    <option value="1">2025å¹´åº¦ä¸‰åŸºç†è®ºè€ƒè¯•</option>
                    <option value="2">å†…ç§‘ä¸‰åŸºè€ƒè¯•</option>
                    <option value="3">å¤–ç§‘ä¸‰åŸºè€ƒè¯•</option>
                </select>
            </div>

            <!-- ç»Ÿè®¡å¡ç‰‡ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>å‚åŠ äººæ•°</h3>
                    <div class="value">{{.stats.totalParticipants}}</div>
                </div>
                <div class="stat-card">
                    <h3>å¹³å‡æˆç»©</h3>
                    <div class="value">{{.stats.avgScore}}åˆ†</div>
                </div>
                <div class="stat-card">
                    <h3>æœ€é«˜åˆ†</h3>
                    <div class="value">{{.stats.maxScore}}åˆ†</div>
                </div>
                <div class="stat-card">
                    <h3>æœ€ä½åˆ†</h3>
                    <div class="value">{{.stats.minScore}}åˆ†</div>
                </div>
                <div class="stat-card">
                    <h3>é€šè¿‡ç‡</h3>
                    <div class="value">{{.stats.passRate}}%</div>
                </div>
                <div class="stat-card">
                    <h3>ä¼˜ç§€ç‡</h3>
                    <div class="value">{{.stats.excellentRate}}%</div>
                </div>
            </div>

            <!-- å›¾è¡¨éƒ¨åˆ† -->
            <div class="charts-container">
                <!-- æˆç»©åˆ†å¸ƒå›¾è¡¨ -->
                <div class="chart-section">
                    <h3>æˆç»©åˆ†å¸ƒ</h3>
                    <div class="chart-container">
                        <!-- è¿™é‡Œå¯ä»¥åµŒå…¥EChartsç­‰å›¾è¡¨åº“ -->
                        <div style="height: 100%; display: flex; align-items: center; justify-content: center; color: #6c757d;">
                            ğŸ“Š æˆç»©åˆ†å¸ƒå›¾è¡¨ï¼ˆå¼€å‘ä¸­ï¼‰
                        </div>
                    </div>
                </div>

                <!-- è€ƒè¯•è¶‹åŠ¿å›¾è¡¨ -->
                <div class="chart-section">
                    <h3>è€ƒè¯•è¶‹åŠ¿</h3>
                    <div class="chart-container">
                        <!-- è¿™é‡Œå¯ä»¥åµŒå…¥EChartsç­‰å›¾è¡¨åº“ -->
                        <div style="height: 100%; display: flex; align-items: center; justify-content: center; color: #6c757d;">
                            ğŸ“ˆ è€ƒè¯•è¶‹åŠ¿å›¾è¡¨ï¼ˆå¼€å‘ä¸­ï¼‰
                        </div>
                    </div>
                </div>
            </div>

            <!-- æˆç»©åˆ†å¸ƒè¡¨æ ¼ -->
            <div class="score-distribution">
                <h3>æˆç»©åˆ†å¸ƒè¯¦æƒ…</h3>
                <div style="overflow-x: auto;">
                    <table class="distribution-table">
                        <thead>
                            <tr>
                                <th>åˆ†æ•°æ®µ</th>
                                <th>äººæ•°</th>
                                <th>å æ¯”</th>
                                <th>å¹³å‡åˆ†</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{if .scoreDistribution}}
                                {{range .scoreDistribution}}
                                <tr>
                                    <td>{{.Range}}</td>
                                    <td>{{.Count}}</td>
                                    <td>{{.Percentage}}%</td>
                                    <td>{{.AvgScore}}åˆ†</td>
                                </tr>
                                {{end}}
                            {{else}}
                                <tr>
                                    <td>90-100åˆ†</td>
                                    <td>15</td>
                                    <td>15%</td>
                                    <td>94åˆ†</td>
                                </tr>
                                <tr>
                                    <td>80-89åˆ†</td>
                                    <td>35</td>
                                    <td>35%</td>
                                    <td>85åˆ†</td>
                                </tr>
                                <tr>
                                    <td>70-79åˆ†</td>
                                    <td>25</td>
                                    <td>25%</td>
                                    <td>75åˆ†</td>
                                </tr>
                                <tr>
                                    <td>60-69åˆ†</td>
                                    <td>15</td>
                                    <td>15%</td>
                                    <td>65åˆ†</td>
                                </tr>
                                <tr>
                                    <td>60åˆ†ä»¥ä¸‹</td>
                                    <td>10</td>
                                    <td>10%</td>
                                    <td>55åˆ†</td>
                                </tr>
                            {{end}}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- æ’åè¡¨æ ¼ -->
            <div class="ranking-section">
                <h3>è€ƒè¯•æ’å</h3>
                <div style="overflow-x: auto;">
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>æ’å</th>
                                <th>å§“å</th>
                                <th>éƒ¨é—¨</th>
                                <th>èŒç§°</th>
                                <th>æˆç»©</th>
                                <th>æ­£ç¡®ç‡</th>
                                <th>ç”¨æ—¶</th>
                                <th>è€ƒè¯•æ—¶é—´</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{if .rankings}}
                                {{range $ranking := .rankings}}
                                <tr class="rank-{{$ranking.Rank}}">
                                    <td>{{$ranking.Rank}}</td>
                                    <td>{{$ranking.Name}}</td>
                                    <td>{{$ranking.Department}}</td>
                                    <td>{{$ranking.JobTitle}}</td>
                                    <td>{{$ranking.Score}}åˆ†</td>
                                    <td>{{$ranking.Accuracy}}%</td>
                                    <td>{{$ranking.TimeUsed}}åˆ†é’Ÿ</td>
                                    <td>{{$ranking.ExamTime}}</td>
                                </tr>
                                {{end}}
                            {{else}}
                                <tr class="rank-1">
                                    <td>1</td>
                                    <td>å¼ ä¸‰</td>
                                    <td>å†…ç§‘</td>
                                    <td>ä¸»æ²»åŒ»å¸ˆ</td>
                                    <td>98åˆ†</td>
                                    <td>98%</td>
                                    <td>95åˆ†é’Ÿ</td>
                                    <td>2025-12-01 10:00</td>
                                </tr>
                                <tr class="rank-2">
                                    <td>2</td>
                                    <td>æå››</td>
                                    <td>å¤–ç§‘</td>
                                    <td>å‰¯ä¸»ä»»åŒ»å¸ˆ</td>
                                    <td>95åˆ†</td>
                                    <td>95%</td>
                                    <td>100åˆ†é’Ÿ</td>
                                    <td>2025-12-01 10:00</td>
                                </tr>
                                <tr class="rank-3">
                                    <td>3</td>
                                    <td>ç‹äº”</td>
                                    <td>å„¿ç§‘</td>
                                    <td>ä¸»æ²»åŒ»å¸ˆ</td>
                                    <td>92åˆ†</td>
                                    <td>92%</td>
                                    <td>105åˆ†é’Ÿ</td>
                                    <td>2025-12-01 10:00</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>èµµå…­</td>
                                    <td>å¦‡äº§ç§‘</td>
                                    <td>ä¸»æ²»åŒ»å¸ˆ</td>
                                    <td>90åˆ†</td>
                                    <td>90%</td>
                                    <td>98åˆ†é’Ÿ</td>
                                    <td>2025-12-01 10:00</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td>å­™ä¸ƒ</td>
                                    <td>å†…ç§‘</td>
                                    <td>ä½é™¢åŒ»å¸ˆ</td>
                                    <td>88åˆ†</td>
                                    <td>88%</td>
                                    <td>110åˆ†é’Ÿ</td>
                                    <td>2025-12-01 10:00</td>
                                </tr>
                            {{end}}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <script>
        // ç”¨æˆ·èœå•äº¤äº’
        document.addEventListener('DOMContentLoaded', function() {
            // ç”¨æˆ·èœå•æ˜¾ç¤º/éšè—
            const userMenuTrigger = document.getElementById('userMenuTrigger');
            const userMenu = document.getElementById('userMenu');
            
            userMenuTrigger.addEventListener('click', function(e) {
                e.preventDefault();
                userMenu.style.display = userMenu.style.display === 'block' ? 'none' : 'block';
            });
            
            // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹å…³é—­èœå•
            document.addEventListener('click', function(e) {
                if (!userMenuTrigger.contains(e.target) && !userMenu.contains(e.target)) {
                    userMenu.style.display = 'none';
                }
            });

            // è€ƒè¯•é€‰æ‹©å™¨å˜åŒ–äº‹ä»¶
            const examSelector = document.getElementById('examSelector');
            examSelector.addEventListener('change', function() {
                const examId = this.value;
                console.log('é€‰æ‹©è€ƒè¯•:', examId);
                // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè°ƒç”¨APIè·å–å¯¹åº”è€ƒè¯•çš„ç»Ÿè®¡æ•°æ®
                // å¹¶æ›´æ–°é¡µé¢å†…å®¹
            });

            console.log('è€ƒè¯•æˆç»©ç»Ÿè®¡åˆ†æé¡µé¢åŠ è½½å®Œæˆ');
        });
    </script>
</body>
</html>